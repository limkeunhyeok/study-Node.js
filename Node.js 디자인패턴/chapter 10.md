# Chapter 10 - 확장성과 구조적 패턴

## 1. 어플리케이션 확장에 대한 소개

## 1-1 Node.js 어플리케이션 확장

<p>
    일반적인 Node.js 어플리케이션의 대부분의 작업이 싱글 스레드의 컨텍스트에서 실행된다. 논 블로킹 I/O에 의해 완벽하게 활용되는 싱글 스레드는 초당 수백 개의 짧은 요청을 처리하는 어플리케이션에 유용하다. 상용 하드웨어를 사용한다고 가정하면 싱글 스레드가 지원할 수 있는 용량은 서버의 성능에 관계없이 제한적이다. 따라서 부하가 많은 어플리케이션에 Node.js를 사용하려는 경우 유일한 방법은 멀티 프로세스와 멀티 머신에 확장하는 것이다.
</p>

<p>
    확장을 통해 작업량 뿐만 아니라 장애에 대한 가용성과 내성 같은 특성을 얻을 수 있다. 확장성은 어플리케이션의 크기와 복잡성에도 적용할 수 있는 중요한 개념이며, 확장 가능한 아키텍처를 구축하는 것은 소프트웨어 설계 시 또 다른 중요 요소이다.
</p>

## 1-2 확장성의 세 가지 차원

<p>
    확장성에서 필요한 첫 번째 기본 원칙은 멀티 프로세스와 멀티 시스템으로 어플리케이션의 부하를 분할하는 부하 분산(load distribution)이다. 이를 달성하는 방법으로 'The Art of Scalability'라는 저서에서는 스케일 큐브(Scale Cube)라고 하는 독창적인 모델을 제시한다. 이 모델은 다음 세 가지 측면에서 확장성을 설명한다.
</p>

- x축: 복제
- y축: 서비스/기능별 분해
- z축: 데이터 파티션 분할

![1](https://user-images.githubusercontent.com/38815618/106353007-b9af9400-632a-11eb-87ce-bc93a8c16eef.PNG)

<p>
    큐브의 왼쪽 아래 모서리는 모든 기능과 서비스를 단일 코드 베이스로한, 단일 인스턴스에서 실행되는 어플리케이션을 나타낸다. 이는 작은 작업량을 처리하거나 개발 초기 단계의 어플리케이션에 공통적인 상황이다.
</p>

<p>
    x축을 따라 확장하는 것은 간단하고 저렴하며 매우 효과적이다. 이 기술 이면의 원리는 동일한 어플리케이션을 n번 복제하고 각 인스턴스가 작업량의 1/n씩을 처리하도록 하는 것이다.
</p>

<p>
    y축을 따라 확장하면 해당 기능, 서비스 또는 유스케이스에 따라 어플리케이션이 분해된다. 이 경우 분해(decomposing)는 각기 다른 코드 베이스가 있는 다른 독립 실행형 어플리케이션을 생성하는 것을 의미하며, 때로는 전용 데이터베이스 또는 별도의 UI를 사용하여 생성하기도 한다. 어플리케이션을 기능별로 분리하는 기준은 주로 비즈니스 요구 사항, use case, 데이터 및 기타 여러 요소에 따라 다르다. 이는 어플리케이션의 아키텍처뿐만 아니라 개발 관점에서 관리되는 방식에도 큰 영향을 미치는 확장성(scale)에 대한 또 하나의 관점이다.
</p>

<p>
    z축을 따라 확장하는 것은 어플리케이션의 각 인스턴스를 전체 데이터의 일부의 처리만을 담당하도록 분할하는 것이다. 이는 주로 데이터베이스에서 사용되는 기술이며 수평 분할 또는 샤딩(sharding)이라 불린다. 이 설정에서는 동일한 어플리케이션의 인스턴스가 여러 개 있으며, 각 인스턴스는 서로 다른 기준을 사용하여 결정되는 데이터 파티션에서 작동한다. 데이터 파티션을 사용하려면 어플리케이션의 어느 인스턴스가 주어진 데이터를 담당하는지 결정하기 위해 각 작업 앞에 조회 단계가 있어야 한다. 데이터 파티셔닝(partitioning)은 대개 거대한 단일 데이터셋을 처리하는 것과 관련한 문제를 극복하기 때문에 데이터베이스 단에서 적용되고 처리된다. 어플리케이션 수준에서 이를 적용하는 것은 복잡하고 분산된 아키텍처 또는 매우 특별한 사용 사례에 대해서만 고려해 볼 가치가 있다. 복잡성을 감안할 때, z축을 따라 확장하는 것은 x, y축을 완전히 활용한 후에만 고려해야 한다.
</p>
